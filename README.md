# 局域网聊天工具

## 分析聊天工具

* 注意：没有服务端，每一个用户都是客户端。
* 功能：上线通知、聊天、发文件、下线通知、远程监控、其他功能。
* 发文件：使用tcp协议。单独写这个功能。正常传输使用udp，文件作为另一功能最后加入。

## 架构
* 现有一个网络接口，专门负责收发数据，即网络接口iNet，有几个子类，是一个纯虚的类，纯虚函数。
	* TCP类和UDP类，TcpNet、UdpNet，即使用不到tcp传输，也要设置接口，以便以后可以使用。
	* 网络接口四种功能：初始化网络、关闭网络、收数据、发数据
	* 接口不管是tcp还是udp都用得到。
* 类单一原则，因此也要有一个ui类。
* 要加一个核心处理类。
	* 例如，ui操作，发送到kernel类，然后把你的信号组织成一个包，然后打包发出去。
	* kernel类和ui在qt写，net在c++写，但是net和kernel需要一个桥梁，最好不要直接接触。
	* 如果直接接触，那么我的net类里面肯定是有与qt相关的操作了，这样net类就被污染了
* 因此提出：需要给net类封装，就需要一个中介者类。
* 每个人都和中介接触。mediator中介者。
	* tcpmediator和udpmediator是中介者的两个子类。
	* 因此，中介者应该与网络一样，人家有什么你中介者就也应该有什么。

## 准备工作
* 创建了cpp之后，进入文件资源管理器
* 然后添加两个目录，net和mediator，为了方便管理
* 每个目录中手动创建cpp和头文件
* 中介者
	* INetMediator.h
	* UdpMediator.cpp
	* UdpMediator.h
* 网络接口
	* INet.h
	* UdpNet.cpp
	* UdpNet.h
* 首先子类暂时先不写udp，此时inet作为父类接口，是不需要写cpp文件的，理由就是这是一个纯虚函数。
* 添加筛选器net和mediator
	* 形如头文件、源文件、外部依赖项，均属于筛选器。用于分文别类。
	* 筛选器添加现有项，框选对应的3个文件。
* 项目——属性——VC++目录——包含目录——下拉编辑
	* 但是问题是，直接添加是绝对路径，我们应该要变成相对路径，要跟随项目
	* 相对的应该是，main文件
	* 到此，可以使用创建的头文件了。

## INet.h
* 接口一定是public
	* 这其中，接收数据是内部函数不会被调用，因此用保护类型。
	* 不能忘记虚析构
* 数据到手，都会转化成char*类型。
	* 实际使用的时候再进行转化。
	* 类似于udp接收文件
* 接口的ip地址来源：33:41